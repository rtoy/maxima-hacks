/*
 * Some simple examples of how to use minimax.
 */

/*
 * Approximate 2^x for x in [0,1]
 */
fpprec:32;
minimax([.01, .1,.3,.6,.65,.7,.75,.8,.85,.9,.95], 2^(x), [0, 1], x, relerr, 10);
[- 2.5929987976937121176327586541399b-6, 
                                      4
1.3534196962019233445584376340776b-2 x
                                         3
 + 5.2011412208524093747641359186673b-2 x
                                         2
 + 2.4144278133284693965698863848957b-1 x
 + 6.9300383050021674424812090364867b-1 x
 + 1.0000025929987976791579740165616b0, 
[0, 8.6149995756883515185768800308445b-2, 
3.2006860198525546834647745839232b-1, 6.2776000248575299605231060511948b-1, 
8.9383900292700078856331113345173b-1, 1]];

/*
 * Compare this with table 1041from Hart et al, which says 2^x
 * approximated by a 4-th order polynomial has precision of 5.58
 * digits. We have -log(2.5929987976937121176327586541399b-6)/log(10) = 5.586.
 * Hart's table is 
 *
 * 1.00000259337 + .6930038344595*x + .2414427569428*x^2 + 0.0520114605441*x^3 + 0.0135341679432*x^4
 *
 * If we plot the difference between these, the max diff occurs at 1
 * with a value of about 7e-10.
 */

/* 
 * Approximate log(x) for x in [0.5, 1]
 */

minimax([.55b0, .6b0, .75b0, .9b0, .95b0], log(x), [.5b0,1], x, abs, 10);
[- 3.4239807002111816505718344672005b-3, 
                                        2
- 9.5612287621791258729331275389995b-1 x
 + 2.8067827526459145914827786327805b0 x
 - 1.8540838571282132196671454948955b0, 
[5.0b-1, 6.0875931229884148576667569554544b-1, 
8.5903464093729331522091973579479b-1, 1]]

/*
 * Compare with Hart table 2601: 2.46 digits,
 *
 * -1.854088 + 2.806795*x-0.9561308*x^2
 *
 * We also get 2.46 digits
 */

/*
 * Use split_interval to get a higher order approximation
 */
split_interval([5.0b-1, 6.0875931229884128966960280010709b-1, 8.590346409372917051640294726743b-1, 1]);
[5.0b-1, 5.5437965614942064483480140005355b-1, 
6.0875931229884128966960280010709b-1, 7.3389697661806649741681613639069b-1, 
8.590346409372917051640294726743b-1, 9.2951732046864585258201473633715b-1, 1]

minimax([5.0b-1, 5.5437965614942064483480140005355b-1, 
6.0875931229884128966960280010709b-1, 7.3389697661806649741681613639069b-1, 
8.590346409372917051640294726743b-1, 9.2951732046864585258201473633715b-1, 1], log(x), [.5b0,1], x, abs, 8);
[- 8.6911957093779049167078798454611b-6, 
                                    5                                        4
9.95328524397072089691107521503b-1 x  - 4.6198391173062587355957475665491b0 x
                                        3
 + 9.0450093326340397226204004255123b0 x
                                        2
 - 9.8448884185672653757137595675886b0 x
 + 7.058609985791127527932076191064b0 x - 2.6342116157530055531310608785134b0, 
[5.0b-1, 5.3020324989762866731849273546643b-1, 
6.1543911378208818272805514943079b-1, 7.3776509197201559830901726681602b-1, 
8.6616974966232063405962631957608b-1, 9.6364029337836721552644167801548b-1, 1]]

/*
 * We get a 5th order approximation with 5.061 digits of precision.
 *
 * Compare with Hart table 2604: 5.06 digits
 *
 * -2.634227768 + 7.058724224*x-9.845205988*x^2+9.045443155*x^3-4.620130503*x^4+0.99540557*x^5
*/
